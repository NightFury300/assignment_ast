<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        /* Style for the buttons */
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            background-color: #28a745; /* Green background */
            color: white; /* White text */
            cursor: pointer; /* Pointer cursor on hover */
        }
        button:hover {
            background-color: #218838; /* Darker green on hover */
        }

        /* Style for the rule list items */
        .rule-item {
            background-color: #f8f9fa; /* Light background color */
            border: 1px solid #dee2e6; /* Light border */
            border-radius: 5px; /* Rounded corners */
            padding: 10px; /* Padding inside the box */
            margin: 10px 0; /* Margin between items */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Slight shadow */
        }
        h1 {
            font-family: 'Arial', sans-serif;
            font-size: 2.5em;
            color: #343a40; /* Dark grey color */
            text-align: center; /* Center the heading */
            margin-bottom: 20px; /* Space below the heading */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1); /* Add a slight shadow */
        }
    </style>
</head>
<body>
    <div>    
        <h1>Condition to AST Tree</h1>
    </div>
    <div>
        <form method="post" action="/api/v1/users/combine-rules">
            <p>Rule List:</p>
            <ol>
                <% if (locals.data !== undefined && locals.data.ruleList !== undefined) { %>
                    <% data.ruleList.forEach(rule => { %>
                        <li class="rule-item"> 
                            <%= rule.rule %> 
                            <input type="checkbox" name="rules[]" value="<%= rule._id %>">
                            <p>Rule ID: <%=rule._id %></p>
                            <textarea id="rule-ast-<%= rule._id %>" style="display:none;"><%= JSON.stringify(rule.ast) %></textarea>
                            <button type="button" onclick="copyToClipboard('<%= JSON.stringify(rule.ast)%>')">
                                Copy AST Tree JSON to Clipboard
                            </button>
                        </li>
                    <% }); %>
                <% } %>
            </ol>
            <button type="submit">Combine the selected Rules</button>
        </form>
    </div>
    <br>
    <div style="position: relative; bottom: 0; left: 0; width: 100%; text-align: left; background-color: #f9f9f9; padding: 10px; box-shadow: 0px -2px 5px rgba(0, 0, 0, 0.1);">
        <form method="post" action="/api/v1/users/create-rule">
            <label>Enter Rule</label>
            <input type="text" name="ruleString">
            <button type="submit">Create Rule</button>
        </form>
        <form method="get" action="/api/v1/users/reset-rules">
            <button style="background-color: #dc3545;" type="submit">Delete All Rules</button>
        </form>
        <form method="post" action="/api/v1/users/evaluate-rule" >
            <label style="margin-left: 10px;">Enter Data (JSON format):</label>
            <input type="text" name="data" placeholder="{&quot;key&quot;:&quot;value&quot;,}" required style="margin-left: 10px;">
            <label style="margin-left: 10px;">Enter Rule ID:</label>
            <input type="text" name="ruleId" > 
            <button type="submit" style="margin-left: 10px;">Evaluate</button>
            <%if (locals.data !== undefined && locals.data.result !== undefined) {%>
                <%if (data.result) { %>
                    <h2 style="color: #218838;"><%=data.result %></h2>
                <%}
                else { %>
                    <h2 style="color: #dc3545;"><%=data.result %></h2>
                <% } %>
            <%}%>
        </form>
    </div>
    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('AST JSON copied to clipboard. ');
            }).catch(err => {
                console.error('Could not copy text: ', err);
            });
        }
    </script>
</body>
</html>
